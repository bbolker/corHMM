\name{summarize_simmaps}
\alias{summarize_single_simmap}
\alias{summarize_transition_stats}
\title{
Summarize Transition Information from Stochastic Character Maps
}
\description{
These functions process and summarize transition events (e.g., character state changes) from one or more stochastic character maps, such as those generated by \code{makeSimmap}.
\code{summarize_single_simmap} extracts a detailed data frame of all transitions from a single stochastic map object.
\code{summarize_transition_stats} takes a list of these data frames (from multiple stochastic maps) and computes summary statistics, such as the average number and timing of each transition type.
}
\usage{
summarize_single_simmap(simmap)
summarize_transition_stats(simmap_summaries)
}
\arguments{
\item{simmap}{An object of class "simmap", representing a single phylogenetic tree with a character history mapped onto it. Typically an element from the list produced by \code{makeSimmap}.}
\item{simmap_summaries}{A list of data frames, where each data frame is the result of applying \code{summarize_single_simmap} to a "simmap" object.}
}
\details{
The intended workflow involves two main steps.
First, one uses \code{lapply} to apply \code{summarize_single_simmap} to each element in a list of stochastic maps (e.g., the output of \code{makeSimmap(..., nsim=100)}). This creates a list of data frames, with each data frame containing the transition history for one simulation.
Second, this list of data frames is passed to \code{summarize_transition_stats} to be aggregated into a final summary table that provides means and standard deviations for transition counts and timings across all simulations.
}
\value{
\code{summarize_single_simmap} returns a data frame with three columns for a single simulation:
\item{branch_id}{The integer ID of the branch on which the transition occurred.}
\item{transition}{A character string describing the transition, e.g., "state1,state2".}
\item{age}{The time at which the transition occurred, measured from the root of the tree.}
\code{summarize_transition_stats} returns a single data frame summarizing all simulations, with the following columns:
\item{transition}{The unique transition type.}
\item{avg_count}{The average number of times this transition occurred per simulation.}
\item{sd_count}{The standard deviation of the count for this transition across simulations.}
\item{avg_age}{The average time (age) at which this transition occurred, across all occurrences in all simulations.}
\item{sd_age}{The standard deviation of the time (age) for this transition.}
}
\examples{
\dontrun{
data(primates)
phy <- primates[[1]]
phy <- multi2di(phy)
data <- primates[[2]]
## run corhmm
MK <- corHMM(phy, data, 1)
## get simmap from corhmm solution
model <- MK$solution
simmaps <- makeSimmap(tree=phy, data=data, model=model, rate.cat=1, nSim=100, nCores=1)
## get the summary
simmap_summaries <- lapply(simmaps, summarize_single_simmap)
summary_df <- summarize_transition_stats(simmap_summaries)
print(summary_df)
}
}
